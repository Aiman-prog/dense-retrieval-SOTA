name: dense-retrieval
channels:
  - conda-forge
  - pytorch
  - defaults
dependencies:
  - python=3.9
  - pytorch>=2.0.0
  - pytorch-cuda=12.1  # CUDA support for PyTorch (compatible with CUDA 12.9)
  - numpy>=1.24.0
  - pandas>=2.0.0
  - pyyaml>=6.0
  - tqdm>=4.65.0
  - spacy  # Install via conda to avoid build issues
  - pip
  - pip:
    # Core ML Libraries (pin versions for Tevatron compatibility)
    - importlib_metadata  # Required by transformers
    - transformers>=4.30.0,<4.36.0
    - sentence-transformers>=2.2.0,<3.0.0
    - datasets>=2.14.0
    - accelerate>=0.20.0,<0.25.0
    # Tevatron and GradCache (only available via pip/GitHub)
    - tevatron>=0.1.0
    - git+https://github.com/luyug/GradCache.git
    # FAISS (use faiss-gpu if GPU available, otherwise faiss-cpu)
    - faiss-gpu>=1.7.0,<1.7.5  # Latest available is 1.7.2
    # Evaluation tools
    - pyserini>=0.22.0
    - pytrec-eval  # Python bindings for trec_eval
    # Utilities
    - safetensors>=0.4.0  # For loading model checkpoints

